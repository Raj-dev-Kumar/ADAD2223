{"ast":null,"code":"import { ClarityType, intCV, uintCV, bufferCV, trueCV, falseCV, standardPrincipalCVFromAddress, contractPrincipalCVFromAddress, responseOkCV, responseErrorCV, noneCV, someCV, listCV, tupleCV } from '.';\nimport { BytesReader } from '../bytesReader';\nimport { deserializeAddress, deserializeLPString } from '../types';\nimport { DeserializationError } from '../errors';\nimport { stringAsciiCV, stringUtf8CV } from './types/stringCV';\nimport { bytesToAscii, bytesToUtf8, hexToBytes } from '@stacks/common';\nexport default function deserializeCV(serializedClarityValue) {\n  var bytesReader;\n  if (typeof serializedClarityValue === 'string') {\n    var hasHexPrefix = serializedClarityValue.slice(0, 2).toLowerCase() === '0x';\n    bytesReader = new BytesReader(hexToBytes(hasHexPrefix ? serializedClarityValue.slice(2) : serializedClarityValue));\n  } else if (serializedClarityValue instanceof Uint8Array) {\n    bytesReader = new BytesReader(serializedClarityValue);\n  } else {\n    bytesReader = serializedClarityValue;\n  }\n  var type = bytesReader.readUInt8Enum(ClarityType, function (n) {\n    throw new DeserializationError(\"Cannot recognize Clarity Type: \".concat(n));\n  });\n  switch (type) {\n    case ClarityType.Int:\n      return intCV(bytesReader.readBytes(16));\n    case ClarityType.UInt:\n      return uintCV(bytesReader.readBytes(16));\n    case ClarityType.Buffer:\n      var bufferLength = bytesReader.readUInt32BE();\n      return bufferCV(bytesReader.readBytes(bufferLength));\n    case ClarityType.BoolTrue:\n      return trueCV();\n    case ClarityType.BoolFalse:\n      return falseCV();\n    case ClarityType.PrincipalStandard:\n      var sAddress = deserializeAddress(bytesReader);\n      return standardPrincipalCVFromAddress(sAddress);\n    case ClarityType.PrincipalContract:\n      var cAddress = deserializeAddress(bytesReader);\n      var contractName = deserializeLPString(bytesReader);\n      return contractPrincipalCVFromAddress(cAddress, contractName);\n    case ClarityType.ResponseOk:\n      return responseOkCV(deserializeCV(bytesReader));\n    case ClarityType.ResponseErr:\n      return responseErrorCV(deserializeCV(bytesReader));\n    case ClarityType.OptionalNone:\n      return noneCV();\n    case ClarityType.OptionalSome:\n      return someCV(deserializeCV(bytesReader));\n    case ClarityType.List:\n      var listLength = bytesReader.readUInt32BE();\n      var listContents = [];\n      for (var i = 0; i < listLength; i++) {\n        listContents.push(deserializeCV(bytesReader));\n      }\n      return listCV(listContents);\n    case ClarityType.Tuple:\n      var tupleLength = bytesReader.readUInt32BE();\n      var tupleContents = {};\n      for (var _i = 0; _i < tupleLength; _i++) {\n        var clarityName = deserializeLPString(bytesReader).content;\n        if (clarityName === undefined) {\n          throw new DeserializationError('\"content\" is undefined');\n        }\n        tupleContents[clarityName] = deserializeCV(bytesReader);\n      }\n      return tupleCV(tupleContents);\n    case ClarityType.StringASCII:\n      var asciiStrLen = bytesReader.readUInt32BE();\n      var asciiStr = bytesToAscii(bytesReader.readBytes(asciiStrLen));\n      return stringAsciiCV(asciiStr);\n    case ClarityType.StringUTF8:\n      var utf8StrLen = bytesReader.readUInt32BE();\n      var utf8Str = bytesToUtf8(bytesReader.readBytes(utf8StrLen));\n      return stringUtf8CV(utf8Str);\n    default:\n      throw new DeserializationError('Unable to deserialize Clarity Value from Uint8Array. Could not find valid Clarity Type.');\n  }\n}","map":{"version":3,"names":["ClarityType","intCV","uintCV","bufferCV","trueCV","falseCV","standardPrincipalCVFromAddress","contractPrincipalCVFromAddress","responseOkCV","responseErrorCV","noneCV","someCV","listCV","tupleCV","BytesReader","deserializeAddress","deserializeLPString","DeserializationError","stringAsciiCV","stringUtf8CV","bytesToAscii","bytesToUtf8","hexToBytes","deserializeCV","serializedClarityValue","bytesReader","hasHexPrefix","slice","toLowerCase","Uint8Array","type","readUInt8Enum","n","concat","Int","readBytes","UInt","Buffer","bufferLength","readUInt32BE","BoolTrue","BoolFalse","PrincipalStandard","sAddress","PrincipalContract","cAddress","contractName","ResponseOk","ResponseErr","OptionalNone","OptionalSome","List","listLength","listContents","i","push","Tuple","tupleLength","tupleContents","clarityName","content","undefined","StringASCII","asciiStrLen","asciiStr","StringUTF8","utf8StrLen","utf8Str"],"sources":["C:\\Users\\rajde\\gitrep\\deploy\\frontend\\node_modules\\@stacks\\transactions\\src\\clarity\\deserialize.ts"],"sourcesContent":["import {\n  ClarityType,\n  ClarityValue,\n  intCV,\n  uintCV,\n  bufferCV,\n  trueCV,\n  falseCV,\n  standardPrincipalCVFromAddress,\n  contractPrincipalCVFromAddress,\n  responseOkCV,\n  responseErrorCV,\n  noneCV,\n  someCV,\n  listCV,\n  tupleCV,\n} from '.';\nimport { BytesReader as BytesReader } from '../bytesReader';\nimport { deserializeAddress, deserializeLPString } from '../types';\nimport { DeserializationError } from '../errors';\nimport { stringAsciiCV, stringUtf8CV } from './types/stringCV';\nimport { bytesToAscii, bytesToUtf8, hexToBytes } from '@stacks/common';\n\n/**\n * Deserializes clarity value to clarity type\n *\n * @param {value} Uint8Array | string value to be converted to clarity type\n **\n * @returns {ClarityType} returns the clarity type instance\n *\n * @example\n * ```\n *  import { intCV, serializeCV, deserializeCV } from '@stacks/transactions';\n *\n *  const serialized = serializeCV(intCV(100)); // Similarly works for other clarity types as well like listCV, booleanCV ...\n *\n *  // <Uint8Array 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 64>\n *\n *  const deserialized = deserializeCV(serialized);\n *  // { type: 0, value: 100n }\n * ```\n *\n * @see\n * {@link https://github.com/hirosystems/stacks.js/blob/main/packages/transactions/tests/clarity.test.ts | clarity test cases for more examples}\n */\nexport default function deserializeCV<T extends ClarityValue = ClarityValue>(\n  serializedClarityValue: BytesReader | Uint8Array | string\n): T {\n  let bytesReader: BytesReader;\n  if (typeof serializedClarityValue === 'string') {\n    const hasHexPrefix = serializedClarityValue.slice(0, 2).toLowerCase() === '0x';\n    bytesReader = new BytesReader(\n      hexToBytes(hasHexPrefix ? serializedClarityValue.slice(2) : serializedClarityValue)\n    );\n  } else if (serializedClarityValue instanceof Uint8Array) {\n    bytesReader = new BytesReader(serializedClarityValue);\n  } else {\n    bytesReader = serializedClarityValue;\n  }\n  const type = bytesReader.readUInt8Enum(ClarityType, n => {\n    throw new DeserializationError(`Cannot recognize Clarity Type: ${n}`);\n  });\n\n  switch (type) {\n    case ClarityType.Int:\n      return intCV(bytesReader.readBytes(16)) as T;\n\n    case ClarityType.UInt:\n      return uintCV(bytesReader.readBytes(16)) as T;\n\n    case ClarityType.Buffer:\n      const bufferLength = bytesReader.readUInt32BE();\n      return bufferCV(bytesReader.readBytes(bufferLength)) as T;\n\n    case ClarityType.BoolTrue:\n      return trueCV() as T;\n\n    case ClarityType.BoolFalse:\n      return falseCV() as T;\n\n    case ClarityType.PrincipalStandard:\n      const sAddress = deserializeAddress(bytesReader);\n      return standardPrincipalCVFromAddress(sAddress) as T;\n\n    case ClarityType.PrincipalContract:\n      const cAddress = deserializeAddress(bytesReader);\n      const contractName = deserializeLPString(bytesReader);\n      return contractPrincipalCVFromAddress(cAddress, contractName) as T;\n\n    case ClarityType.ResponseOk:\n      return responseOkCV(deserializeCV(bytesReader)) as T;\n\n    case ClarityType.ResponseErr:\n      return responseErrorCV(deserializeCV(bytesReader)) as T;\n\n    case ClarityType.OptionalNone:\n      return noneCV() as T;\n\n    case ClarityType.OptionalSome:\n      return someCV(deserializeCV(bytesReader)) as T;\n\n    case ClarityType.List:\n      const listLength = bytesReader.readUInt32BE();\n      const listContents: ClarityValue[] = [];\n      for (let i = 0; i < listLength; i++) {\n        listContents.push(deserializeCV(bytesReader));\n      }\n      return listCV(listContents) as T;\n\n    case ClarityType.Tuple:\n      const tupleLength = bytesReader.readUInt32BE();\n      const tupleContents: { [key: string]: ClarityValue } = {};\n      for (let i = 0; i < tupleLength; i++) {\n        const clarityName = deserializeLPString(bytesReader).content;\n        if (clarityName === undefined) {\n          throw new DeserializationError('\"content\" is undefined');\n        }\n        tupleContents[clarityName] = deserializeCV(bytesReader);\n      }\n      return tupleCV(tupleContents) as T;\n\n    case ClarityType.StringASCII:\n      const asciiStrLen = bytesReader.readUInt32BE();\n      const asciiStr = bytesToAscii(bytesReader.readBytes(asciiStrLen));\n      return stringAsciiCV(asciiStr) as T;\n\n    case ClarityType.StringUTF8:\n      const utf8StrLen = bytesReader.readUInt32BE();\n      const utf8Str = bytesToUtf8(bytesReader.readBytes(utf8StrLen));\n      return stringUtf8CV(utf8Str) as T;\n\n    default:\n      throw new DeserializationError(\n        'Unable to deserialize Clarity Value from Uint8Array. Could not find valid Clarity Type.'\n      );\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}