{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/rajde/gitrep/deploy/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/rajde/gitrep/deploy/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _classCallCheck from \"C:/Users/rajde/gitrep/deploy/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/Users/rajde/gitrep/deploy/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport { sha256 } from '@noble/hashes/sha256';\nimport { sha512 } from '@noble/hashes/sha512';\nimport { getCryptoLib } from './cryptoUtils';\nexport var NodeCryptoSha2Hash = /*#__PURE__*/function () {\n  function NodeCryptoSha2Hash(createHash) {\n    _classCallCheck(this, NodeCryptoSha2Hash);\n    this.createHash = createHash;\n  }\n  _createClass(NodeCryptoSha2Hash, [{\n    key: \"digest\",\n    value: function () {\n      var _digest = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(data) {\n        var algorithm,\n          result,\n          _args = arguments;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              algorithm = _args.length > 1 && _args[1] !== undefined ? _args[1] : 'sha256';\n              _context.prev = 1;\n              result = this.createHash(algorithm).update(data).digest();\n              return _context.abrupt(\"return\", Promise.resolve(result));\n            case 6:\n              _context.prev = 6;\n              _context.t0 = _context[\"catch\"](1);\n              console.log(_context.t0);\n              console.log(\"Error performing \".concat(algorithm, \" digest with Node.js 'crypto.createHash', falling back to JS implementation.\"));\n              return _context.abrupt(\"return\", Promise.resolve(algorithm === 'sha256' ? hashSha256Sync(data) : hashSha512Sync(data)));\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this, [[1, 6]]);\n      }));\n      function digest(_x) {\n        return _digest.apply(this, arguments);\n      }\n      return digest;\n    }()\n  }]);\n  return NodeCryptoSha2Hash;\n}();\nexport var WebCryptoSha2Hash = /*#__PURE__*/function () {\n  function WebCryptoSha2Hash(subtleCrypto) {\n    _classCallCheck(this, WebCryptoSha2Hash);\n    this.subtleCrypto = subtleCrypto;\n  }\n  _createClass(WebCryptoSha2Hash, [{\n    key: \"digest\",\n    value: function () {\n      var _digest2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(data) {\n        var algorithm,\n          algo,\n          hash,\n          _args2 = arguments;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              algorithm = _args2.length > 1 && _args2[1] !== undefined ? _args2[1] : 'sha256';\n              if (!(algorithm === 'sha256')) {\n                _context2.next = 5;\n                break;\n              }\n              algo = 'SHA-256';\n              _context2.next = 10;\n              break;\n            case 5:\n              if (!(algorithm === 'sha512')) {\n                _context2.next = 9;\n                break;\n              }\n              algo = 'SHA-512';\n              _context2.next = 10;\n              break;\n            case 9:\n              throw new Error(\"Unsupported hash algorithm \".concat(algorithm));\n            case 10:\n              _context2.prev = 10;\n              _context2.next = 13;\n              return this.subtleCrypto.digest(algo, data);\n            case 13:\n              hash = _context2.sent;\n              return _context2.abrupt(\"return\", new Uint8Array(hash));\n            case 17:\n              _context2.prev = 17;\n              _context2.t0 = _context2[\"catch\"](10);\n              console.log(_context2.t0);\n              console.log(\"Error performing \".concat(algorithm, \" digest with WebCrypto, falling back to JS implementation.\"));\n              return _context2.abrupt(\"return\", Promise.resolve(algorithm === 'sha256' ? hashSha256Sync(data) : hashSha512Sync(data)));\n            case 22:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this, [[10, 17]]);\n      }));\n      function digest(_x2) {\n        return _digest2.apply(this, arguments);\n      }\n      return digest;\n    }()\n  }]);\n  return WebCryptoSha2Hash;\n}();\nexport function createSha2Hash() {\n  return _createSha2Hash.apply(this, arguments);\n}\nfunction _createSha2Hash() {\n  _createSha2Hash = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n    var cryptoLib;\n    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n      while (1) switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.next = 2;\n          return getCryptoLib();\n        case 2:\n          cryptoLib = _context3.sent;\n          if (!(cryptoLib.name === 'subtleCrypto')) {\n            _context3.next = 7;\n            break;\n          }\n          return _context3.abrupt(\"return\", new WebCryptoSha2Hash(cryptoLib.lib));\n        case 7:\n          return _context3.abrupt(\"return\", new NodeCryptoSha2Hash(cryptoLib.lib.createHash));\n        case 8:\n        case \"end\":\n          return _context3.stop();\n      }\n    }, _callee3);\n  }));\n  return _createSha2Hash.apply(this, arguments);\n}\nexport function hashSha256Sync(data) {\n  return sha256(data);\n}\nexport function hashSha512Sync(data) {\n  return sha512(data);\n}","map":{"version":3,"names":["sha256","sha512","getCryptoLib","NodeCryptoSha2Hash","createHash","_classCallCheck","_createClass","key","value","_digest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","data","algorithm","result","_args","arguments","wrap","_callee$","_context","prev","next","length","undefined","update","digest","abrupt","Promise","resolve","t0","console","log","concat","hashSha256Sync","hashSha512Sync","stop","_x","apply","WebCryptoSha2Hash","subtleCrypto","_digest2","_callee2","algo","hash","_args2","_callee2$","_context2","Error","sent","Uint8Array","_x2","createSha2Hash","_createSha2Hash","_callee3","cryptoLib","_callee3$","_context3","name","lib"],"sources":["C:\\Users\\rajde\\gitrep\\deploy\\frontend\\node_modules\\@stacks\\encryption\\src\\sha2Hash.ts"],"sourcesContent":["import { sha256 } from '@noble/hashes/sha256';\nimport { sha512 } from '@noble/hashes/sha512';\nimport { getCryptoLib } from './cryptoUtils';\n\ntype NodeCryptoCreateHash = typeof import('crypto').createHash;\n\nexport interface Sha2Hash {\n  digest(data: Uint8Array, algorithm?: 'sha256' | 'sha512'): Promise<Uint8Array>;\n}\n\nexport class NodeCryptoSha2Hash {\n  createHash: NodeCryptoCreateHash;\n\n  constructor(createHash: NodeCryptoCreateHash) {\n    this.createHash = createHash;\n  }\n\n  async digest(data: Uint8Array, algorithm = 'sha256'): Promise<Uint8Array> {\n    try {\n      const result = this.createHash(algorithm).update(data).digest();\n      return Promise.resolve(result);\n    } catch (error) {\n      console.log(error);\n      console.log(\n        `Error performing ${algorithm} digest with Node.js 'crypto.createHash', falling back to JS implementation.`\n      );\n      return Promise.resolve(algorithm === 'sha256' ? hashSha256Sync(data) : hashSha512Sync(data));\n    }\n  }\n}\n\nexport class WebCryptoSha2Hash implements Sha2Hash {\n  subtleCrypto: SubtleCrypto;\n\n  constructor(subtleCrypto: SubtleCrypto) {\n    this.subtleCrypto = subtleCrypto;\n  }\n\n  async digest(data: Uint8Array, algorithm = 'sha256'): Promise<Uint8Array> {\n    let algo: string;\n    if (algorithm === 'sha256') {\n      algo = 'SHA-256';\n    } else if (algorithm === 'sha512') {\n      algo = 'SHA-512';\n    } else {\n      throw new Error(`Unsupported hash algorithm ${algorithm}`);\n    }\n    try {\n      const hash = await this.subtleCrypto.digest(algo, data);\n      return new Uint8Array(hash);\n    } catch (error) {\n      console.log(error);\n      console.log(\n        `Error performing ${algorithm} digest with WebCrypto, falling back to JS implementation.`\n      );\n      return Promise.resolve(algorithm === 'sha256' ? hashSha256Sync(data) : hashSha512Sync(data));\n    }\n  }\n}\n\nexport async function createSha2Hash(): Promise<Sha2Hash> {\n  const cryptoLib = await getCryptoLib();\n  if (cryptoLib.name === 'subtleCrypto') {\n    return new WebCryptoSha2Hash(cryptoLib.lib);\n  } else {\n    return new NodeCryptoSha2Hash(cryptoLib.lib.createHash);\n  }\n}\n\nexport function hashSha256Sync(data: Uint8Array) {\n  return sha256(data);\n}\n\nexport function hashSha512Sync(data: Uint8Array) {\n  return sha512(data);\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}